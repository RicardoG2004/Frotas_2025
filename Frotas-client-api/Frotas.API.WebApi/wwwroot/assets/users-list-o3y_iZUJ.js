import{_ as ye}from"./layout-bRPLI_qW.js";import{C as he,D as ae,E as I,r as A,c as se,d as N,e as k,f as K,w as s,i as a,j as b,m as g,g as t,t as w,k as _,h as e,I as D,v as F,p as de,n as ue,a as Ve,l as te,A as ce,F as me,y as Ue,G as le,o as xe}from"./index-nCaapDSo.js";import{_ as we,a as Ae}from"./active-badge-FFtF6b_V.js";import{u as _e,_ as ie}from"./loading-button-HDMC2WxA.js";import{c as pe,a as C,d as $e}from"./index.esm-ckVFB3Pu.js";import{_ as fe}from"./_plugin-vue_export-helper-x3n3nnut.js";import{_ as Ie,d as Ce}from"./avatar-title-group-t4BuFJuh.js";import"./logo-TZSfwjHH.js";const be=he("users",{state:()=>({userList:[]}),getters:{users:l=>l.userList},actions:{async getUsers(){const l=await ae.get("/identity/users");this.userList=l.data},async addUser(l){try{const o=await ae.post("/identity/users",l);if(o.succeeded){const i=[o.data,...this.userList];return this.userList=i,I.success("User created"),!0}else return I.error(o.messages[0]),!1}catch{return I.error(error),!1}},async updateUser(l){try{const o=await ae.put(`/identity/users/${l.id}`,l);if(console.log(o),o.succeeded){const i=this.userList.map(r=>r.id===l.id?l:r);return this.userList=i,I.success("User updated"),!0}else return I.error(o.messages[0]),!1}catch(o){return I.error(o),!1}},async deleteUser(l){try{const o=await ae.delete(`/identity/users/${l}`);if(o.succeeded){const i=this.userList.filter(r=>r.id!==l);return this.userList=i,I.success("User deleted"),!0}else return I.error(o.messages[0]),!1}catch(o){return I.error(o),!1}}}}),oe=l=>(de("data-v-48f798b0"),l=l(),ue(),l),ke={class:"form-layout"},Se=oe(()=>e("div",{class:"form-block-title"},"Role Assignment",-1)),Re={class:"d-inline-flex flex-wrap"},Le={class:"radio-group me-2 mb-1"},Ee=oe(()=>e("label",{for:"registerAdminRole",class:"radio-group__label"},[e("span",{class:"radio-group__label__button"}),e("div",{class:"radio-group__label__text"},[e("div",{class:"radio-group__label__text__title"},"Admin")])],-1)),Pe={class:"radio-group me-2 mb-1"},Be=oe(()=>e("label",{for:"registerEditorRole",class:"radio-group__label"},[e("span",{class:"radio-group__label__button"}),e("div",{class:"radio-group__label__text"},[e("div",{class:"radio-group__label__text__title"},"Editor")])],-1)),qe={class:"radio-group me-2 mb-1"},De=oe(()=>e("label",{for:"registerBasicRole",class:"radio-group__label"},[e("span",{class:"radio-group__label__button"}),e("div",{class:"radio-group__label__text"},[e("div",{class:"radio-group__label__text__title"},"Basic")])],-1)),Fe={class:"modal-footer border-top-0"},Me={__name:"register-user-modal",props:{data:{type:Object,required:!1},loading:{type:Boolean,default:!1}},emits:["proceed","cancel"],setup(l,{emit:o}){const i=o,r=A({firstName:"",lastName:"",email:"",password:"Password123!",phoneNumber:"",roleId:"basic"}),y=pe({firstName:C().required(),lastName:C().required(),email:C().email().required(),password:C().required(),roleId:C().required()}),{handleSubmit:$,defineField:p,errors:c,meta:V}=_e({initialValues:r,validationSchema:y}),[U,f]=p("firstName"),[v,B]=p("lastName"),[q,M]=p("email"),[z,H]=p("phoneNumber"),[j,O]=p("password"),[x,h]=p("roleId"),G=se(()=>V.value.dirty&&V.value.valid),T=A(!0),S=async()=>{T.value=!1,i("cancel")},R=$(Q=>{i("proceed",Q)});return(Q,n)=>{const L=N("b-form-input"),E=N("b-form-invalid-feedback"),P=N("b-form-group"),W=N("b-button"),X=N("b-modal");return k(),K(X,{id:"standard-modal",modelValue:T.value,"onUpdate:modelValue":n[9]||(n[9]=d=>T.value=d),title:"Register New User","title-class":"h4",size:"lg","hide-footer":"",onCancel:S,onClose:S,onHidden:S},{default:s(()=>[e("form",{onSubmit:n[8]||(n[8]=(...d)=>a(R)&&a(R)(...d))},[e("div",ke,[t(P,{label:"First Name","label-for":"firstName"},{default:s(()=>[t(L,g({type:"text"},a(f),{modelValue:a(U),"onUpdate:modelValue":n[0]||(n[0]=d=>b(U)?U.value=d:null),id:"firstName",placeholder:"First Name"}),null,16,["modelValue"]),t(E,{state:!1},{default:s(()=>[_(w(a(c).firstName),1)]),_:1})]),_:1}),t(P,{label:"Last Name","label-for":"lastName"},{default:s(()=>[t(L,g({type:"text"},a(B),{modelValue:a(v),"onUpdate:modelValue":n[1]||(n[1]=d=>b(v)?v.value=d:null),id:"lastName",placeholder:"Last Name"}),null,16,["modelValue"]),t(E,{state:!1},{default:s(()=>[_(w(a(c).lastName),1)]),_:1})]),_:1}),t(P,{label:"Email","label-for":"email"},{default:s(()=>[t(L,g({type:"email"},a(M),{modelValue:a(q),"onUpdate:modelValue":n[2]||(n[2]=d=>b(q)?q.value=d:null),id:"email",placeholder:"name@example.com"}),null,16,["modelValue"]),t(E,{state:!1},{default:s(()=>[_(w(a(c).email),1)]),_:1})]),_:1}),t(P,{label:"Phone","label-for":"phoneNumber"},{default:s(()=>[t(L,g({type:"tel"},a(H),{modelValue:a(z),"onUpdate:modelValue":n[3]||(n[3]=d=>b(z)?z.value=d:null),id:"phoneNumber",placeholder:"Phone Number"}),null,16,["modelValue"]),t(E,{state:!1},{default:s(()=>[_(w(a(c).phoneNumber),1)]),_:1})]),_:1}),t(P,{label:"Password","label-for":"password"},{default:s(()=>[t(L,g({type:"text"},a(O),{modelValue:a(j),"onUpdate:modelValue":n[4]||(n[4]=d=>b(j)?j.value=d:null),id:"password",placeholder:"Password"}),null,16,["modelValue"]),t(E,{state:!1},{default:s(()=>[_(w(a(c).password),1)]),_:1})]),_:1})]),Se,e("div",Re,[e("div",Le,[F(e("input",g({name:"roleId",type:"radio",class:"radio-group__input",id:"registerAdminRole",value:"admin"},a(h),{"onUpdate:modelValue":n[5]||(n[5]=d=>b(x)?x.value=d:null)}),null,16),[[D,a(x)]]),Ee]),e("div",Pe,[F(e("input",g({name:"roleId",type:"radio",class:"radio-group__input",id:"registerEditorRole",value:"editor"},a(h),{"onUpdate:modelValue":n[6]||(n[6]=d=>b(x)?x.value=d:null)}),null,16),[[D,a(x)]]),Be]),e("div",qe,[F(e("input",g({name:"roleId",type:"radio",class:"radio-group__input",id:"registerBasicRole",value:"basic"},a(h),{"onUpdate:modelValue":n[7]||(n[7]=d=>b(x)?x.value=d:null)}),null,16),[[D,a(x)]]),De])])],32),e("div",Fe,[t(W,{variant:"light",onClick:S},{default:s(()=>[_("Close")]),_:1}),t(ie,{variant:"primary",type:"submit",loading:l.loading,onClick:a(R),disabled:!G.value},{default:s(()=>[_("Save")]),_:1},8,["loading","onClick","disabled"])])]),_:1},8,["modelValue"])}}},ze=fe(Me,[["__scopeId","data-v-48f798b0"]]),re=l=>(de("data-v-c88bad17"),l=l(),ue(),l),He={class:"form-layout"},je=re(()=>e("div",{class:"form-block-title"},"Role Assignment",-1)),Oe={class:"d-inline-flex flex-wrap"},Ge={class:"radio-group me-2 mb-1"},Te=re(()=>e("label",{for:"registerAdminRole",class:"radio-group__label"},[e("span",{class:"radio-group__label__button"}),e("div",{class:"radio-group__label__text"},[e("div",{class:"radio-group__label__text__title"},"Admin")])],-1)),Je={class:"radio-group me-2 mb-1"},Ke=re(()=>e("label",{for:"registerEditorRole",class:"radio-group__label"},[e("span",{class:"radio-group__label__button"}),e("div",{class:"radio-group__label__text"},[e("div",{class:"radio-group__label__text__title"},"Editor")])],-1)),Qe={class:"radio-group me-2 mb-1"},We=re(()=>e("label",{for:"registerBasicRole",class:"radio-group__label"},[e("span",{class:"radio-group__label__button"}),e("div",{class:"radio-group__label__text"},[e("div",{class:"radio-group__label__text__title"},"Basic")])],-1)),Xe={class:"modal-footer footer-controls border-top-0"},Ye={class:"footer-controls__left"},Ze={class:"footer-controls__right"},ea={__name:"edit-user-modal",props:{data:{type:Object,required:!1},saving:{type:Boolean,default:!1},deleting:{type:Boolean,default:!1}},emits:["proceed","cancel","proceedDelete"],setup(l,{emit:o}){var L,E,P,W,X,d;const i=o,r=l,y=A({firstName:((L=r.data)==null?void 0:L.firstName)||"",lastName:((E=r.data)==null?void 0:E.lastName)||"",email:((P=r.data)==null?void 0:P.email)||"",isActive:((W=r.data)==null?void 0:W.isActive)||!1,phone:((X=r.data)==null?void 0:X.phone)||"",roleId:((d=r.data)==null?void 0:d.roleId)||"basic"}),$=pe({firstName:C().required(),lastName:C().required(),email:C().email().required(),roleId:C().required(),isActive:$e().required()}),{handleSubmit:p,defineField:c,errors:V,meta:U}=_e({initialValues:y,validationSchema:$}),[f,v]=c("isActive"),[B,q]=c("firstName"),[M,z]=c("lastName"),[H,j]=c("email"),[O,x]=c("phoneNumber"),[h,G]=c("roleId"),T=se(()=>U.value.dirty&&U.value.valid),S=A(!0),R=async()=>{S.value=!1,i("cancel")},Q=p(ne=>{let u={...r.data,...ne};i("proceed",u)}),n=p(()=>{i("proceedDelete",r.data.id)});return(ne,u)=>{const ge=N("b-form-checkbox"),Y=N("b-form-input"),Z=N("b-form-invalid-feedback"),ee=N("b-form-group"),ve=N("b-button"),Ne=N("b-modal");return k(),K(Ne,{id:"standard-modal",modelValue:S.value,"onUpdate:modelValue":u[8]||(u[8]=m=>S.value=m),title:"Edit User","title-class":"h4",size:"lg","hide-footer":"",onCancel:R,onClose:R,onHidden:R},{default:s(()=>[e("form",null,[t(ge,g(a(v),{modelValue:a(f),"onUpdate:modelValue":u[0]||(u[0]=m=>b(f)?f.value=m:null),switch:""}),{default:s(()=>[_(" Is Active")]),_:1},16,["modelValue"]),e("div",He,[t(ee,{label:"First Name","label-for":"firstName"},{default:s(()=>[t(Y,g({type:"text"},a(q),{modelValue:a(B),"onUpdate:modelValue":u[1]||(u[1]=m=>b(B)?B.value=m:null),id:"firstName",placeholder:"First Name"}),null,16,["modelValue"]),t(Z,{state:!1},{default:s(()=>[_(w(a(V).firstName),1)]),_:1})]),_:1}),t(ee,{label:"Last Name","label-for":"lastName"},{default:s(()=>[t(Y,g({type:"text"},a(z),{modelValue:a(M),"onUpdate:modelValue":u[2]||(u[2]=m=>b(M)?M.value=m:null),id:"lastName",placeholder:"Last Name"}),null,16,["modelValue"]),t(Z,{state:!1},{default:s(()=>[_(w(a(V).lastName),1)]),_:1})]),_:1}),t(ee,{label:"Email","label-for":"email"},{default:s(()=>[t(Y,g({type:"email"},a(j),{modelValue:a(H),"onUpdate:modelValue":u[3]||(u[3]=m=>b(H)?H.value=m:null),id:"email",placeholder:"name@example.com"}),null,16,["modelValue"]),t(Z,{state:!1},{default:s(()=>[_(w(a(V).email),1)]),_:1})]),_:1}),t(ee,{label:"Phone","label-for":"phoneNumber"},{default:s(()=>[t(Y,g({type:"tel"},a(x),{modelValue:a(O),"onUpdate:modelValue":u[4]||(u[4]=m=>b(O)?O.value=m:null),id:"phoneNumber",placeholder:"Phone Number"}),null,16,["modelValue"]),t(Z,{state:!1},{default:s(()=>[_(w(a(V).phoneNumber),1)]),_:1})]),_:1})]),je,e("div",Oe,[e("div",Ge,[F(e("input",g({name:"roleId",type:"radio",class:"radio-group__input",id:"registerAdminRole",value:"admin"},a(G),{"onUpdate:modelValue":u[5]||(u[5]=m=>b(h)?h.value=m:null)}),null,16),[[D,a(h)]]),Te]),e("div",Je,[F(e("input",g({name:"roleId",type:"radio",class:"radio-group__input",id:"registerEditorRole",value:"editor"},a(G),{"onUpdate:modelValue":u[6]||(u[6]=m=>b(h)?h.value=m:null)}),null,16),[[D,a(h)]]),Ke]),e("div",Qe,[F(e("input",g({name:"roleId",type:"radio",class:"radio-group__input",id:"registerBasicRole",value:"basic"},a(G),{"onUpdate:modelValue":u[7]||(u[7]=m=>b(h)?h.value=m:null)}),null,16),[[D,a(h)]]),We])])]),e("div",Xe,[e("div",Ye,[t(ie,{variant:"danger",type:"submit",loading:l.deleting,onClick:a(n),disabled:l.saving},{default:s(()=>[_("Delete")]),_:1},8,["loading","onClick","disabled"])]),e("div",Ze,[t(ve,{variant:"light",onClick:R},{default:s(()=>[_("Close")]),_:1}),t(ie,{variant:"primary",type:"submit",loading:l.saving,onClick:a(Q),disabled:!T.value},{default:s(()=>[_("Save")]),_:1},8,["loading","onClick","disabled"])])])]),_:1},8,["modelValue"])}}},aa=fe(ea,[["__scopeId","data-v-c88bad17"]]),la={key:1,class:"float-end text-primary"},ta={__name:"edit-user",props:["targetUser"],setup(l){const o=be(),i=Ve(),r=l,y=A(!1),$=A(!1),p=A(!1),c=async f=>{$.value=!0,await o.updateUser(f)&&(y.value=!1),$.value=!1},V=async f=>{p.value=!0,await o.deleteUser(f)&&(y.value=!1),p.value=!1},U=se(()=>{var f,v;return i.user.id==((f=r.targetUser)==null?void 0:f.id)?!1:((v=r.targetUser)==null?void 0:v.roleId)!="root"});return(f,v)=>{const B=N("b-button");return k(),te(me,null,[U.value?(k(),K(B,{key:0,variant:"soft-primary",pill:"",onClick:v[0]||(v[0]=q=>y.value=!0),class:"float-end"},{default:s(()=>[_("Edit")]),_:1})):(k(),te("strong",la,"N/A")),y.value?(k(),K(aa,{key:2,saving:$.value,deleting:p.value,data:r.targetUser,onProceed:c,onProceedDelete:V,onCancel:v[1]||(v[1]=q=>y.value=!1)},null,8,["saving","deleting","data"])):ce("",!0)],64)}}},sa={__name:"role-badge",props:["role"],setup(l){const o=l,i=se(()=>{switch(o.role){case"root":return"bg-success";case"admin":return"bg-success";case"editor":return"bg-info";case"basic":return"bg-info"}});return(r,y)=>(k(),te("span",{class:Ue(["badge badge-lg text-light",i.value])},w(l.role),3))}},J=Ce(),oa=[J.accessor("firstName",{label:"Name",enableSorting:!0,cell:({row:l})=>le(Ie,{title:l.original.firstName+" "+l.original.lastName,image:l.original.imageUrl})}),J.accessor("roleId",{label:"Role",enableSorting:!0,cell:({row:l})=>le(sa,{role:l.original.roleId})}),J.accessor("email",{label:"Email",enableSorting:!0}),J.accessor("isActive",{label:"Active",enableSorting:!0,size:30,cell:({row:l})=>le(we,{isActive:l.original.isActive})}),J.accessor("edit",{label:"",enableSorting:!1,cell:({row:l})=>le(ta,{targetUser:l.original})})],ra=e("div",{class:"mb-2"},[e("small",null,"Client-side pagination with sorting & filtering")],-1),fa={__name:"users-list",setup(l){const o=be(),i=A(!1),r=A(!1),y=A(!1);xe(async()=>{r.value=!0,await o.getUsers(),r.value=!1});const $=async p=>{y.value=!0,await o.addUser(p)&&(i.value=!1),y.value=!1};return(p,c)=>{const V=N("b-button"),U=N("b-col"),f=N("b-row");return k(),te(me,null,[t(ye,null,{default:s(()=>[t(f,null,{default:s(()=>[t(U,{class:"d-flex flex-row-reverse mb-3"},{default:s(()=>[t(V,{variant:"primary",onClick:c[0]||(c[0]=v=>i.value=!i.value)},{default:s(()=>[_("New User")]),_:1})]),_:1})]),_:1}),t(f,null,{default:s(()=>[t(U,null,{default:s(()=>[t(Ae,{data:a(o).users,columns:a(oa),loading:r.value,filterPlaceholder:"Search Users..."},null,8,["data","columns","loading"]),ra]),_:1})]),_:1})]),_:1}),i.value?(k(),K(ze,{key:0,loading:y.value,onProceed:$,onCancel:c[1]||(c[1]=v=>i.value=!1)},null,8,["loading"])):ce("",!0)],64)}}};export{fa as default};
